<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DDWin Sports</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

    <script>
        function toggleCriteria() {
            var selectElement = document.getElementById("criterio");
            var criteriaInputs = document.querySelectorAll(".criterio-input");
            var pontosInput = document.querySelector('[name="criterio_pontos"]');
            var rebotesInput = document.querySelector('[name="criterio_rebotes"]');
            var assistenciasInput = document.querySelector('[name="criterio_assistencias"]');
            var trespontosInput = document.querySelector('[name="criterio_trespontos"]');
            var roubosInput = document.querySelector('[name="criterio_roubos"]');
            var bloqueiosInput = document.querySelector('[name="criterio_bloqueios"]');
            var carregarEstatisticasButton = document.querySelector('button[type="submit"]');

            if (selectElement.value === "damus_sports") {
                criteriaInputs.forEach(input => {
                    input.setAttribute("disabled", "true");
                    input.classList.add("disabled");
                    input.value = 0;
                });
                pontosInput.value = 4;
                rebotesInput.value = 3;
                assistenciasInput.value = 2;
                trespontosInput.value = 2;
                roubosInput.value = 2;
                bloqueiosInput.value = 2;

                pontosInput.setAttribute("disabled", "true");
                rebotesInput.setAttribute("disabled", "true");
                assistenciasInput.setAttribute("disabled", "true");
                trespontosInput.setAttribute("disabled", "true");
                roubosInput.setAttribute("disabled", "true");
                bloqueiosInput.setAttribute("disabled", "true");

                pontosInput.classList.add("disabled");
                rebotesInput.classList.add("disabled");
                assistenciasInput.classList.add("disabled");
                trespontosInput.classList.add("disabled");
                roubosInput.classList.add("disabled");
                bloqueiosInput.classList.add("disabled");

            } else if (selectElement.value === "outro_criterio") {
                criteriaInputs.forEach(input => {
                    input.removeAttribute("disabled");
                    input.classList.remove("disabled");

                    if (input.value === "") {
                        input.value = 0.0;
                    }
                });

                if (pontosInput.value === "") pontosInput.value = 0.0;
                if (rebotesInput.value === "") rebotesInput.value = 0.0;
                if (assistenciasInput.value === "") assistenciasInput.value = 0.0;
                if (trespontosInput.value === "") trespontosInput.value = 0.0;
                if (roubosInput.value === "") roubosInput.value = 0.0;
                if (bloqueiosInput.value === "") bloqueiosInput.value = 0.0;

                pontosInput.removeAttribute("disabled");
                rebotesInput.removeAttribute("disabled");
                assistenciasInput.removeAttribute("disabled");
                trespontosInput.removeAttribute("disabled");
                roubosInput.removeAttribute("disabled");
                bloqueiosInput.removeAttribute("disabled");

                pontosInput.classList.remove("disabled");
                rebotesInput.classList.remove("disabled");
                assistenciasInput.classList.remove("disabled");
                trespontosInput.classList.remove("disabled");
                roubosInput.classList.remove("disabled");
                bloqueiosInput.classList.remove("disabled");
            } else {
                criteriaInputs.forEach(input => {
                    input.removeAttribute("disabled");
                    input.classList.remove("disabled");
                });

                pontosInput.removeAttribute("disabled");
                rebotesInput.removeAttribute("disabled");
                assistenciasInput.removeAttribute("disabled");
                trespontosInput.removeAttribute("disabled");
                roubosInput.removeAttribute("disabled");
                bloqueiosInput.removeAttribute("disabled");

                pontosInput.classList.remove("disabled");
                rebotesInput.classList.remove("disabled");
                assistenciasInput.classList.remove("disabled");
                trespontosInput.classList.remove("disabled");
                roubosInput.classList.remove("disabled");
                bloqueiosInput.classList.remove("disabled");
            }

            if (carregarEstatisticasButton) {
                carregarEstatisticasButton.addEventListener("click", function () {
                    const criterioSelecionado = document.getElementById("criterio").value;

                    setTimeout(() => {
                        document.getElementById("criterio").value = criterioSelecionado;
                        verificarCampos();
                    }, 100);
                });
            }
        }

        window.onload = function () {
            toggleCriteria();
        };
    </script>
</head>

<body>

    {% include 'header.html' %}

    <h2 class="titulo-principal">NBA: Matchup Ataque x Defesa</h2>
    <form method="POST">

        <!-- FILTRO TIME VISITANTE | TIME MANDANTE -->

        <div class="filtros-container">
            <div class="filtro">
                <label for="away_team" class="titulos_1">Time Visitante:</label>
                <select name="away_team" id="away_team">
                    <option value="" disabled selected>Clique aqui para definir o time visitante</option>
                    {% for team in nba_teams %}
                    <option value="{{ team['id'] }}" {% if team['id']==time_visitante %}selected{% endif %}>
                        {{ team['full_name'] }}
                    </option>
                    {% endfor %}
                </select>
            </div>

            <div class="filtro">
                <label for="home_team" class="titulos_1">Time Mandante:</label>
                <select name="home_team" id="home_team">
                    <option value="" disabled selected>Clique aqui para definir o time mandante</option>
                    {% for team in nba_teams %}
                    <option value="{{ team['id'] }}" {% if team['id']==time_mandante %}selected{% endif %}>
                        {{ team['full_name'] }}
                    </option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="filtros-container">

            <!-- FILTRO DE ESCOLHA DE CRITÉRIO -->

            <div class="filtro">
                <label for="criterio" class="titulos_2">Escolha o critério:</label>
                <select name="criterio" id="criterio" onchange="toggleCriteria()">
                    <option value="0" {% if criterio=='0' %}selected{% endif %}>Clique aqui para definir o critério
                    </option>
                    <option value="damus_sports" {% if criterio=='damus_sports' %}selected{% endif %}>Critério Damus
                        Sports</option>
                    <option value="outro_criterio" {% if criterio=='outro_criterio' %}selected{% endif %}>Critério
                        Personalizado</option>
                </select>
            </div>

            <!-- FILTRO DE JOGOS -->

            <div class="filtro">
                <label for="filter" class="titulos_2">Filtro de Jogos:</label>
                <select name="filter" id="filter">
                    <option value="regular" {% if filtro=='regular' %}selected{% endif %}>Temporada Regular</option>
                    <option value="last_10" {% if filtro=='last_10' %}selected{% endif %}>Últimos 10 Jogos</option>
                    <option value="last_9" {% if filtro=='last_9' %}selected{% endif %}>Últimos 9 Jogos</option>
                    <option value="last_8" {% if filtro=='last_8' %}selected{% endif %}>Últimos 8 Jogos</option>
                    <option value="last_7" {% if filtro=='last_7' %}selected{% endif %}>Últimos 7 Jogos</option>
                    <option value="last_6" {% if filtro=='last_6' %}selected{% endif %}>Últimos 6 Jogos</option>
                    <option value="last_5" {% if filtro=='last_5' %}selected{% endif %}>Últimos 5 Jogos</option>
                    <option value="last_4" {% if filtro=='last_4' %}selected{% endif %}>Últimos 4 Jogos</option>
                    <option value="last_3" {% if filtro=='last_3' %}selected{% endif %}>Últimos 3 Jogos</option>
                    <option value="last_2" {% if filtro=='last_2' %}selected{% endif %}>Últimos 2 Jogos</option>
                </select>
            </div>
        </div>

        <!-- FILTRO DE JOGADORES -->

        <div class="filtro">
            <label for="filter_jogadores" class="titulos_2">Filtro de Jogadores:</label>
            <select name="filter_jogadores" id="filter_jogadores">
                <option value="regular" {% if filtro_jogadores=='regular' %}selected{% endif %}>Temporada Regular
                </option>
                <option value="last_10" {% if filtro_jogadores=='last_10' %}selected{% endif %}>Últimos 10 Jogos
                </option>
                <option value="last_5" {% if filtro_jogadores=='last_5' %}selected{% endif %}>Últimos 5 Jogos</option>
            </select>
        </div>

        <!-- TABELA CRITÉRIOS DE MATCHUP -->

        <div class="tabelas-criterios-container">
            <table class="tabela-criterios">
                <thead>
                    <tr>
                        <th colspan="7" class="titulos_2">Critérios de Matchup</th> <!-- Título da tabela -->
                    </tr>
                    <tr class="cabecalho-desktop"> <!-- Cabeçalho visível apenas no desktop -->
                        <th>Critérios</th>
                        <th>Pontos</th>
                        <th>Rebotes</th>
                        <th>Assistências</th>
                        <th>Três Pontos</th>
                        <th>Roubos</th>
                        <th>Bloqueios</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Linha para desktop -->
                    <tr class="linha-desktop">
                        <td>Valor</td>
                        <td>
                            <select name="criterio_pontos" class="criterio-input">
                                {% for valor in valores_criterios %}
                                <option value="{{ valor }}" {% if criterios_selecionados["Pontos"]==valor %}selected{%
                                    endif %}>
                                    {% if valor == "menor que -10" %}
                                    Menor que -10
                                    {% elif valor == "maior que 10" %}
                                    Maior que 10
                                    {% else %}
                                    {{ valor }}
                                    {% endif %}
                                </option>
                                {% endfor %}
                            </select>
                        </td>
                        <td>
                            <select name="criterio_rebotes" class="criterio-input">
                                {% for valor in valores_criterios %}
                                <option value="{{ valor }}" {% if criterios_selecionados["Rebotes"]==valor %}selected{%
                                    endif %}>
                                    {% if valor == "menor que -10" %}
                                    Menor que -10
                                    {% elif valor == "maior que 10" %}
                                    Maior que 10
                                    {% else %}
                                    {{ valor }}
                                    {% endif %}
                                </option>
                                {% endfor %}
                            </select>
                        </td>
                        <td>
                            <select name="criterio_assistencias" class="criterio-input">
                                {% for valor in valores_criterios %}
                                <option value="{{ valor }}" {% if criterios_selecionados["Assistências"]==valor
                                    %}selected{% endif %}>
                                    {% if valor == "menor que -10" %}
                                    Menor que -10
                                    {% elif valor == "maior que 10" %}
                                    Maior que 10
                                    {% else %}
                                    {{ valor }}
                                    {% endif %}
                                </option>
                                {% endfor %}
                            </select>
                        </td>
                        <td>
                            <select name="criterio_trespontos" class="criterio-input">
                                {% for valor in valores_criterios %}
                                <option value="{{ valor }}" {% if criterios_selecionados["Três Pontos"]==valor
                                    %}selected{% endif %}>
                                    {% if valor == "menor que -10" %}
                                    Menor que -10
                                    {% elif valor == "maior que 10" %}
                                    Maior que 10
                                    {% else %}
                                    {{ valor }}
                                    {% endif %}
                                </option>
                                {% endfor %}
                            </select>
                        </td>
                        <td>
                            <select name="criterio_roubos" class="criterio-input">
                                {% for valor in valores_criterios %}
                                <option value="{{ valor }}" {% if criterios_selecionados["Roubos"]==valor %}selected{%
                                    endif %}>
                                    {% if valor == "menor que -10" %}
                                    Menor que -10
                                    {% elif valor == "maior que 10" %}
                                    Maior que 10
                                    {% else %}
                                    {{ valor }}
                                    {% endif %}
                                </option>
                                {% endfor %}
                            </select>
                        </td>
                        <td>
                            <select name="criterio_bloqueios" class="criterio-input">
                                {% for valor in valores_criterios %}
                                <option value="{{ valor }}" {% if criterios_selecionados["Bloqueios"]==valor
                                    %}selected{% endif %}>
                                    {% if valor == "menor que -10" %}
                                    Menor que -10
                                    {% elif valor == "maior que 10" %}
                                    Maior que 10
                                    {% else %}
                                    {{ valor }}
                                    {% endif %}
                                </option>
                                {% endfor %}
                            </select>
                        </td>
                    </tr>

                    <!-- Linha para mobile -->
                    <tr class="linha-mobile">
                        <td colspan="7">
                            <div class="criterio-mobile">
                                <span>Pontos</span>
                                <select name="criterio_pontos" class="criterio-input">
                                    {% for valor in valores_criterios %}
                                    <option value="{{ valor }}" {% if criterios_selecionados["Pontos"]==valor
                                        %}selected{% endif %}>
                                        {% if valor == "menor que -10" %}
                                        Menor que -10
                                        {% elif valor == "maior que 10" %}
                                        Maior que 10
                                        {% else %}
                                        {{ valor }}
                                        {% endif %}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="criterio-mobile">
                                <span>Rebotes</span>
                                <select name="criterio_rebotes" class="criterio-input">
                                    {% for valor in valores_criterios %}
                                    <option value="{{ valor }}" {% if criterios_selecionados["Rebotes"]==valor
                                        %}selected{% endif %}>
                                        {% if valor == "menor que -10" %}
                                        Menor que -10
                                        {% elif valor == "maior que 10" %}
                                        Maior que 10
                                        {% else %}
                                        {{ valor }}
                                        {% endif %}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="criterio-mobile">
                                <span>Assistências</span>
                                <select name="criterio_assistencias" class="criterio-input">
                                    {% for valor in valores_criterios %}
                                    <option value="{{ valor }}" {% if criterios_selecionados["Assistências"]==valor
                                        %}selected{% endif %}>
                                        {% if valor == "menor que -10" %}
                                        Menor que -10
                                        {% elif valor == "maior que 10" %}
                                        Maior que 10
                                        {% else %}
                                        {{ valor }}
                                        {% endif %}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="criterio-mobile">
                                <span>Três Pontos</span>
                                <select name="criterio_trespontos" class="criterio-input">
                                    {% for valor in valores_criterios %}
                                    <option value="{{ valor }}" {% if criterios_selecionados["Três Pontos"]==valor
                                        %}selected{% endif %}>
                                        {% if valor == "menor que -10" %}
                                        Menor que -10
                                        {% elif valor == "maior que 10" %}
                                        Maior que 10
                                        {% else %}
                                        {{ valor }}
                                        {% endif %}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="criterio-mobile">
                                <span>Roubos</span>
                                <select name="criterio_roubos" class="criterio-input">
                                    {% for valor in valores_criterios %}
                                    <option value="{{ valor }}" {% if criterios_selecionados["Roubos"]==valor
                                        %}selected{% endif %}>
                                        {% if valor == "menor que -10" %}
                                        Menor que -10
                                        {% elif valor == "maior que 10" %}
                                        Maior que 10
                                        {% else %}
                                        {{ valor }}
                                        {% endif %}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            <div class="criterio-mobile">
                                <span>Bloqueios</span>
                                <select name="criterio_bloqueios" class="criterio-input">
                                    {% for valor in valores_criterios %}
                                    <option value="{{ valor }}" {% if criterios_selecionados["Bloqueios"]==valor
                                        %}selected{% endif %}>
                                        {% if valor == "menor que -10" %}
                                        Menor que -10
                                        {% elif valor == "maior que 10" %}
                                        Maior que 10
                                        {% else %}
                                        {{ valor }}
                                        {% endif %}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- BOTÃO CARREGAR ESTATÍSTICA | REINICIAR PÁGINA -->

        <button type="submit" id="carregarEstatisticas" disabled>Carregar Estatísticas</button>
        <button type="button" id="reiniciarPagina">Reiniciar Página</button>

        <script>
            document.getElementById("reiniciarPagina").addEventListener("click", function () {
                window.location.href = window.location.pathname;
            });
        </script>

        <script>
            function verificarCampos() {
                var homeTeam = document.getElementById("home_team").value;
                var awayTeam = document.getElementById("away_team").value;
                var criterio = document.getElementById("criterio").value;
                var filtroJogadores = document.getElementById("filter_jogadores").value;
                var botao = document.getElementById("carregarEstatisticas");

                if (homeTeam && awayTeam && criterio !== "0" && filtroJogadores) {
                    botao.removeAttribute("disabled");
                } else {
                    botao.setAttribute("disabled", "true");
                }
            }

            document.getElementById("home_team").addEventListener("change", verificarCampos);
            document.getElementById("away_team").addEventListener("change", verificarCampos);
            document.getElementById("criterio").addEventListener("change", verificarCampos);
            document.getElementById("filter_jogadores").addEventListener("change", verificarCampos);

            window.onload = verificarCampos;
        </script>

    </form>


    <!-- TABELA RESULTADOS -->

    {% macro render_table(nome_time, media_time, media_oponente, resultado_matchup, criterio_pontos, tipo) %}
    <div class="tabela-resultados-container">
        <h3 class="titulos_3">{{ nome_time }}</h3>
        <table class="tabela-resultados">
            <tr>
                <th class="cabecalho-tabela-resultados">Critério</th>
                <th class="cabecalho-tabela-resultados">Média</th>
                <th class="cabecalho-tabela-resultados">Projeção</th>
                <th class="cabecalho-tabela-resultados">Resultado</th>
                <th class="cabecalho-tabela-resultados">Matchup</th>
            </tr>
            {% set criterios = {
            "pontos": ["Tm", "Opp"],
            "rebotes": ["Trb", "Trbc"],
            "assistencias": ["Ast", "Astp"],
            "trespontos": ["3pt", "3ptp"],
            "roubos": ["Stl", "Stlp"],
            "bloqueios": ["Blk", "Blkp"]
            } %}

            {% set criterios_traduzidos = {
            "pontos": "Pontos",
            "rebotes": "Rebotes",
            "assistencias": "Assistências",
            "trespontos": "Três Pontos",
            "roubos": "Roubos",
            "bloqueios": "Bloqueios"
            } %}

            {% for criterio, colunas in criterios.items() %}
            <tr>
                <td>{{ criterios_traduzidos[criterio] }}</td>
                <td>{{ (media_time[colunas[0]] if media_time and colunas[0] in media_time else 0) | round(2) }}</td>
                <td>{{ "%.2f"|format(((media_time[colunas[0]] if media_time and colunas[0] in media_time else 0) +
                    (media_oponente[colunas[1]] if media_oponente and colunas[1] in media_oponente else 0)) / 2) }}</td>
                <td>{{ "%.2f"|format(resultado_matchup[tipo + "_" + criterio] or 0) }}</td>
                <td>
                    {% set criterio_var = "criterio_" + criterio %}
                    {% if (resultado_matchup[tipo + "_" + criterio] or 0) >= (valores_criterio[criterio_var] | float) %}
                    <div class="semaforo" style="background-color: green; display: inline-block;"></div>
                    {% else %}
                    <div class="semaforo" style="background-color: red; display: inline-block;"></div>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>
    {% endmacro %}

    <div class="secao-container">
        <h2 class="titulo-resultados">Resultados do Matchup Ataque x Defesa</h2>
        <div class="tabelas-lado-a-lado">
            {{ render_table(nome_visitante, media_visitante, media_mandante, resultado_matchup, criterio_pontos,
            'visitante') }}
            {{ render_table(nome_mandante, media_mandante, media_visitante, resultado_matchup, criterio_pontos,
            'mandante') }}
        </div>
    </div>


    <!-- TABELA PONTOS TOTAIS | HANDICAP -->

    <div class="secao-container">
        <div class="tabelas-lado-a-lado">

            <!-- TABELA PONTOS TOTAIS -->
            <div class="tabela-pontostotais-container">
                <h2 class="titulo-pontostotais">Pontos | Totais (Over/Under)</h2>
                <table class="tabela-pontostotais">
                    <tr>
                        <th class="cabecalho-tabela-pontostotais">Ov/Un</th>
                        <th class="cabecalho-tabela-pontostotais">Média</th>
                        <th class="cabecalho-tabela-pontostotais">Projeção</th>
                        <th class="cabecalho-tabela-pontostotais">Valor</th>
                        <th class="cabecalho-tabela-pontostotais mobile-header" data-mobile="Res.">Resultado</th>
                    </tr>
                    <tr>
                        <td>Over</td>
                        <td>
                            {% if media_visitante and media_mandante and 'Tm' in media_visitante and 'Tm' in
                            media_mandante %}
                            {{ "%.2f"|format(media_visitante['Tm'] + media_mandante['Tm']) }}
                            {% else %}
                            0
                            {% endif %}
                        </td>
                        <td id="totalprojecaoover">
                            {% if media_visitante and media_mandante and 'Tm' in media_visitante and 'Opp' in
                            media_mandante and 'Tm' in media_mandante and 'Opp' in media_visitante %}
                            {{ "%.2f"|format(((media_visitante['Tm'] + media_mandante['Opp']) / 2) +
                            ((media_mandante['Tm'] + media_visitante['Opp']) / 2)) }}
                            {% else %}
                            0
                            {% endif %}
                        </td>
                        <td>
                            <input type="number" step="0.01" class="input-sem-setas"
                                style="width: 80%; box-sizing: border-box; border: 1.3px solid #ffc333; padding: 5px; text-align: center;"
                                id="input-totalpontos-over" onchange="analisarPontosTotaisOver()" />
                        <td>
                            <div id="semaforo-totalpontos-over" class="semaforo"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>Under</td>
                        <td>
                            {% if media_visitante and media_mandante and 'Tm' in media_visitante and 'Tm' in
                            media_mandante %}
                            {{ "%.2f"|format(media_visitante['Tm'] + media_mandante['Tm']) }}
                            {% else %}
                            0
                            {% endif %}
                        </td>
                        <td id="totalprojecaounder">
                            {% if media_visitante and media_mandante and 'Tm' in media_visitante and 'Opp' in
                            media_mandante and 'Tm' in media_mandante and 'Opp' in media_visitante %}
                            {{ "%.2f"|format(((media_visitante['Tm'] + media_mandante['Opp']) / 2) +
                            ((media_mandante['Tm'] + media_visitante['Opp']) / 2)) }}
                            {% else %}
                            0
                            {% endif %}
                        </td>
                        <td>
                            <input type="number" step="0.01" class="input-sem-setas"
                                style="width: 80%; box-sizing: border-box; border: 1.3px solid #ffc333; padding: 5px; text-align: center;"
                                id="input-totalpontos-under" onchange="analisarPontosTotaisUnder()" />
                        <td>
                            <div id="semaforo-totalpontos-under" class="semaforo"></div>
                        </td>
                    </tr>
                </table>
                <div id="frases-analise-totalpontos-over" class="frases-analise"></div>
                <div id="frases-analise-totalpontos-under" class="frases-analise"></div>
            </div>

            <!-- TABELA HANDICAP -->

            <div class="tabela-handicap-container" data-nome-visitante="{{ nome_visitante }}"
                data-nome-mandante="{{ nome_mandante }}">
                <h2 class="titulo-handicap">Handicap</h2>
                <table class="tabela-handicap">
                    <tr>
                        <th class="cabecalho-tabela-handicap">Time</th>
                        <th class="cabecalho-tabela-handicap">Média</th>
                        <th class="cabecalho-tabela-handicap mobile-header" data-mobile="Proj.">Projeção</th>
                        <th class="cabecalho-tabela-handicap">Valor</th>
                        <th class="cabecalho-tabela-handicap mobile-header" data-mobile="Res.">Resultado</th>
                    </tr>
                    <tr>
                        <td>
                            <span class="mobile-nome" id="mobile-nome-visitante"></span>
                            <span class="desktop-nome">{{ nome_visitante }}</span>
                        </td>
                        <td>
                            {% if media_mandante and media_visitante and 'Tm' in media_mandante and 'Tm' in
                            media_visitante %}
                            {% set diferenca = media_mandante['Tm'] - media_visitante['Tm'] %}
                            {% if diferenca > 0 %}
                            +{{ "%.1f"|format(diferenca) }}
                            {% else %}
                            {{ "%.1f"|format(diferenca) }}
                            {% endif %}
                            {% else %}
                            0
                            {% endif %}
                        </td>
                        <td id="totalprojecaohandicapvisitante">
                            {% if media_mandante and media_visitante and 'Tm' in media_mandante and 'Opp' in
                            media_visitante and 'Tm' in media_visitante and 'Opp' in media_mandante %}
                            {% set diferenca = ((media_mandante['Tm'] + media_visitante['Opp']) / 2) -
                            ((media_visitante['Tm'] + media_mandante['Opp']) / 2) %}
                            {% if diferenca > 0 %}
                            +{{ "%.1f"|format(diferenca) }}
                            {% else %}
                            {{ "%.1f"|format(diferenca) }}
                            {% endif %}
                            {% else %}
                            0
                            {% endif %}
                        </td>
                        <td>
                            <input type="number" step="0.01" class="input-sem-setas"
                                style="width: 80%; box-sizing: border-box; border: 1.3px solid #ffc333; padding: 5px; text-align: center;"
                                id="input-handicap-visitante" onchange="analisarHandicapVisitante()" />
                        <td>
                            <div id="semaforo-handicap-visitante" class="semaforo"></div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span class="mobile-nome" id="mobile-nome-mandante"></span>
                            <span class="desktop-nome">{{ nome_mandante }}</span>
                        </td>
                        <td>
                            {% if media_visitante and media_mandante and 'Tm' in media_visitante and 'Tm' in
                            media_mandante %}
                            {% set diferenca = media_visitante['Tm'] - media_mandante['Tm'] %}
                            {% if diferenca > 0 %}
                            +{{ "%.1f"|format(diferenca) }}
                            {% else %}
                            {{ "%.1f"|format(diferenca) }}
                            {% endif %}
                            {% else %}
                            0
                            {% endif %}
                        </td>
                        <td id="totalprojecaohandicapmandante">
                            {% if media_visitante and media_mandante and 'Tm' in media_visitante and 'Opp' in
                            media_mandante and 'Tm' in media_mandante and 'Opp' in media_visitante %}
                            {% set diferenca = ((media_visitante['Tm'] + media_mandante['Opp']) / 2) -
                            ((media_mandante['Tm'] + media_visitante['Opp']) / 2) %}
                            {% if diferenca > 0 %}
                            +{{ "%.1f"|format(diferenca) }}
                            {% else %}
                            {{ "%.1f"|format(diferenca) }}
                            {% endif %}
                            {% else %}
                            0
                            {% endif %}
                        </td>
                        <td>
                            <input type="number" step="0.01" class="input-sem-setas"
                                style="width: 80%; box-sizing: border-box; border: 1.3px solid #ffc333; padding: 5px; text-align: center;"
                                id="input-handicap-mandante" onchange="analisarHandicapMandante()" />
                        <td>
                            <div id="semaforo-handicap-mandante" class="semaforo"></div>
                        </td>
                    </tr>
                </table>
                <div id="frases-analise-handicap-visitante" class="frases-analise"></div>
                <div id="frases-analise-handicap-mandante" class="frases-analise"></div>
            </div>
        </div>
    </div>

    <!-- TABELA PONTOS POR TIME -->

    <div class="secao-container">
        <h2 class="titulo-pontostime">Pontos por Time | Totais (Under/Over)</h2>
        <div class="tabelas-lado-a-lado">

            <!-- TABELA VISITANTE -->
            <div class="tabela-pontostime-container">
                <h3 class="titulos_3">{{ nome_visitante }}</h3>
                <table class="tabela-pontostime">
                    <thead>
                        <tr>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2"
                                data-mobile="Pts&#10Prev.">Pontos Previstos (Ataque)</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2"
                                data-mobile="Pts&#10Perm.">Pontos Permitidos (Defesa)</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" colspan="2" data-mobile="Rk Def.">
                                Ranking (Defesa)</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2" data-mobile="Valor">Valor
                            </th>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2" data-mobile="L10">Últimas
                                10</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2" data-mobile="L10&#10%">
                                Últimas 10 %</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2" data-mobile="Res">Result.
                            </th>
                        </tr>
                        <tr>
                            <th class="cabecalho-tabela-pontostime mobile-header" data-mobile="RS">Regular Season</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" data-mobile="L5">Last 5</th>
                        </tr>
                    </thead>

                    <!-- Over -->
                    <tbody>
                        <tr>
                            <td colspan="8" style="background-color:#ffc333; font-weight:bold; text-align:center;">Over
                            </td>
                        </tr>
                        <tr>
                            <td id="pontos-previstos-visitante-over">
                                {{ "%.2f"|format(((media_visitante['Tm'] if media_visitante and 'Tm' in media_visitante
                                else 0) + (media_mandante['Opp'] if media_mandante and 'Opp' in media_mandante else 0))
                                / 2) }}
                            </td>
                            <td id="pontos-permitidos-visitante-over">
                                {{ "%.2f"|format(media_mandante['Opp'] if media_mandante and 'Opp' in media_visitante
                                else 0) }}
                            </td>
                            <td id="ranking-temp-visitante-over">-</td>
                            <td id="ranking-last5-visitante-over">-</td>
                            <td>
                                <input type="number" step="0.01" class="input-sem-setas"
                                    style="width: 80%; box-sizing: border-box; border: 1.3px solid #ffc333; padding: 5px; text-align: center;"
                                    id="input-visitante-over"
                                    onchange="calcularFrequencia(this, 'frequencia-visitante-over', 'percentual-visitante-over', '{{ nome_visitante }}', 'over')" />
                            </td>
                            <td id="frequencia-visitante-over">-</td>
                            <td id="percentual-visitante-over">-</td>
                            <td>
                                <div id="semaforo-visitante-over" class="semaforo"></div>
                            </td>
                        </tr>
                        <!-- Under -->
                        <tr>
                            <td colspan="8" style="background-color:#ffc333; font-weight:bold; text-align:center;">Under
                            </td>
                        </tr>
                        <tr>
                            <td id="pontos-previstos-visitante-under">
                                {{ "%.2f"|format(((media_visitante['Tm'] if media_visitante and 'Tm' in media_visitante
                                else 0) + (media_mandante['Opp'] if media_mandante and 'Opp' in media_mandante else 0))
                                / 2) }}
                            </td>
                            <td id="pontos-permitidos-visitante-under">
                                {{ "%.2f"|format(media_mandante['Opp'] if media_mandante and 'Opp' in media_mandante
                                else 0) }}
                            </td>
                            <td id="ranking-temp-visitante-under">-</td>
                            <td id="ranking-last5-visitante-under">-</td>
                            <td>
                                <input type="number" step="0.01" class="input-sem-setas"
                                    style="width: 80%; box-sizing: border-box; border: 1.3px solid #ffc333; padding: 5px; text-align: center;"
                                    id="input-visitante-under"
                                    onchange="calcularFrequencia(this, 'frequencia-visitante-under', 'percentual-visitante-under', '{{ nome_visitante }}', 'under')" />
                            </td>
                            <td id="frequencia-visitante-under">-</td>
                            <td id="percentual-visitante-under">-</td>
                            <td>
                                <div id="semaforo-visitante-under" class="semaforo"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div id="frases-analise-visitante-over" class="frases-analise"></div>
                <div id="frases-analise-visitante-under" class="frases-analise"></div>
            </div>

            <!-- TABELA MANDANTE -->
            <div class="tabela-pontostime-container">
                <h3 class="titulos_3">{{ nome_mandante }}</h3>
                <table class="tabela-pontostime">
                    <thead>
                        <tr>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2"
                                data-mobile="Pts&#10Prev.">Pontos Previstos (Ataque)</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2"
                                data-mobile="Pts&#10Perm.">Pontos Permitidos (Defesa)</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" colspan="2" data-mobile="Rk Def.">
                                Ranking (Defesa)</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2" data-mobile="Valor">Valor
                            </th>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2" data-mobile="L10">Últimas
                                10</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2" data-mobile="L10&#10%">
                                Últimas 10 %</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" rowspan="2" data-mobile="Res">Result.
                            </th>
                        </tr>
                        <tr>
                            <th class="cabecalho-tabela-pontostime mobile-header" data-mobile="RS">Regular Season</th>
                            <th class="cabecalho-tabela-pontostime mobile-header" data-mobile="L5">Last 5</th>
                        </tr>
                    </thead>

                    <!-- Over -->
                    <tbody>
                        <tr>
                            <td colspan="8" style="background-color:#ffc333; font-weight:bold; text-align:center;">Over
                            </td>
                        </tr>
                        <tr>
                            <td id="pontos-previstos-mandante-over">
                                {{ "%.2f"|format(((media_mandante['Tm'] if media_mandante and 'Tm' in media_mandante
                                else 0) + (media_visitante['Opp'] if media_visitante and 'Opp' in media_visitante else
                                0)) / 2) }}
                            </td>
                            <td id="pontos-permitidos-mandante-over">
                                {{ "%.2f"|format(media_visitante['Opp'] if media_visitante and 'Opp' in media_visitante
                                else 0) }}
                            </td>
                            <td id="ranking-temp-mandante-over">-</td>
                            <td id="ranking-last5-mandante-over">-</td>
                            <td>
                                <input type="number" step="0.01" class="input-sem-setas"
                                    style="width: 80%; box-sizing: border-box; border: 1.3px solid #ffc333; padding: 5px; text-align: center;"
                                    id="input-mandante-over"
                                    onchange="calcularFrequencia(this, 'frequencia-mandante-over', 'percentual-mandante-over', '{{ nome_mandante }}', 'over')" />
                            </td>
                            <td id="frequencia-mandante-over">-</td>
                            <td id="percentual-mandante-over">-</td>
                            <td>
                                <div id="semaforo-mandante-over" class="semaforo"></div>
                            </td>
                        </tr>
                        <!-- Under -->
                        <tr>
                            <td colspan="8" style="background-color:#ffc333; font-weight:bold; text-align:center;">Under
                            </td>
                        </tr>
                        <tr>
                            <td id="pontos-previstos-mandante-under">
                                {{ "%.2f"|format(((media_mandante['Tm'] if media_mandante and 'Tm' in media_mandante
                                else 0) + (media_visitante['Opp'] if media_visitante and 'Opp' in media_visitante else
                                0)) / 2) }}
                            </td>
                            <td id="pontos-permitidos-mandante-under">
                                {{ "%.2f"|format(media_visitante['Opp'] if media_visitante and 'Opp' in media_visitante
                                else 0) }}
                            </td>
                            <td id="ranking-temp-mandante-under">-</td>
                            <td id="ranking-last5-mandante-under">-</td>
                            <td>
                                <input type="number" step="0.01" class="input-sem-setas"
                                    style="width: 80%; box-sizing: border-box; border: 1.3px solid #ffc333; padding: 5px; text-align: center;"
                                    id="input-mandante-under"
                                    onchange="calcularFrequencia(this, 'frequencia-mandante-under', 'percentual-mandante-under', '{{ nome_mandante }}', 'under')" />
                            </td>
                            <td id="frequencia-mandante-under">-</td>
                            <td id="percentual-mandante-under">-</td>
                            <td>
                                <div id="semaforo-mandante-under" class="semaforo"></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div id="frases-analise-mandante-over" class="frases-analise"></div>
                <div id="frases-analise-mandante-under" class="frases-analise"></div>
            </div>
        </div>
    </div>

    <!-- TABELA DE JOGADORES -->

    <div class="secao-container">
        <h2 class="titulo-jogadores">Jogadores com Matchup Positivo</h2>
        <div class="tabelas-lado-a-lado">

            <!-- TABELA VISITANTE -->
            <div class="tabela-jogadores-container">
                <h3 class="titulos_3">{{ nome_visitante }}</h3>
                <table id="tabela-jogadores-visitante" class="tabela-jogadores">
                    <tr>
                        <th class="cabecalho-tabela-jogadores">Player</th>
                        <th class="cabecalho-tabela-jogadores">Média</th>
                        <th class="cabecalho-tabela-jogadores">Valor</th>
                        <th class="cabecalho-tabela-jogadores">Resultado</th>
                    </tr>

                    {% if dados_jogadores_visitante %}
                    {% for criterio, jogadores in dados_jogadores_visitante.items() %}
                    <!-- Linha do critério -->
                    <tr data-criterio="{{ criterio }}">
                        <td colspan="4" style="background-color:#ffc333; font-weight:bold; text-align:center;">
                            {{ criterio }}
                        </td>
                    </tr>

                    <!-- Linhas dos jogadores -->
                    {% for jogador in jogadores %}
                    <tr data-criterio="{{ criterio }}">
                        <td>{{ jogador.Player }}</td>
                        <td class="media-jogadores-visitante">
                            {{ jogador.Media }}
                        </td>
                        <td>
                            <input type="number" step="0.01" class="input-sem-setas input-jogadores-visitante"
                                style="width: 80%; box-sizing: border-box; border: 1.3px solid #ffc333; padding: 5px; text-align: center;"
                                onchange="analisarJogadoresVisitante(this)" />
                        </td>
                        <td>
                            <div class="semaforo-jogadores-visitante semaforo"></div>
                        </td>
                    </tr>
                    {% endfor %}
                    {% endfor %}
                    {% else %}
                    <tr>
                        <td colspan="4">Nenhum dado disponível.</td>
                    </tr>
                    {% endif %}
                </table>
            </div>

            <!-- TABELA MANDANTE -->
            <div class="tabela-jogadores-container">
                <h3 class="titulos_3">{{ nome_mandante }}</h3>
                <table id="tabela-jogadores-mandante" class="tabela-jogadores">
                    <tr>
                        <th class="cabecalho-tabela-jogadores">Player</th>
                        <th class="cabecalho-tabela-jogadores">Média</th>
                        <th class="cabecalho-tabela-jogadores">Valor</th>
                        <th class="cabecalho-tabela-jogadores">Resultado</th>
                    </tr>

                    {% if dados_jogadores_mandante %}
                    {% for criterio, jogadores in dados_jogadores_mandante.items() %}
                    <!-- Linha do critério -->
                    <tr data-criterio="{{ criterio }}">
                        <td colspan="4" style="background-color:#ffc333; font-weight:bold; text-align:center;">
                            {{ criterio }}
                        </td>
                    </tr>

                    <!-- Linhas dos jogadores -->
                    {% for jogador in jogadores %}
                    <tr data-criterio="{{ criterio }}">
                        <td>{{ jogador.Player }}</td>
                        <td class="media-jogadores-mandante">
                            {{ jogador.Media }}
                        </td>
                        <td>
                            <input type="number" step="0.01" class="input-sem-setas input-jogadores-mandante"
                                style="width: 80%; box-sizing: border-box; border: 1.3px solid #ffc333; padding: 5px; text-align: center;"
                                onchange="analisarJogadoresMandante(this)" />
                        </td>
                        <td>
                            <div class="semaforo-jogadores-mandante semaforo"></div>
                        </td>
                    </tr>
                    {% endfor %}
                    {% endfor %}
                    {% else %}
                    <tr>
                        <td colspan="4">Nenhum dado disponível.</td>
                    </tr>
                    {% endif %}
                </table>
            </div>

        </div>
    </div>

    <!-- Footer -->
    {% include 'footer.html' %}  

    <script>

        // FUNÇÕES JAVASCRIPT

        // FUNÇÃO CABEÇALHO

        window.addEventListener('scroll', function() {
            const topBar = document.querySelector('.top-bar');
            const header = document.querySelector('header');
            const scrollY = window.scrollY;

            if (scrollY > 40) {
                // Move o header para cima, sobrepondo o top-bar
                header.style.top = `${Math.max(0, 60 - scrollY)}px`;

                // Quando o header chegar ao topo, aplica o estilo sticky
                if (scrollY >= 60) {
                    header.classList.add('sticky');
                    topBar.style.top = "-60px"; // Oculta o top-bar
                    header.style.zIndex = "1001"; // Garante que o header fique acima do top-bar
                } else {
                    header.classList.remove('sticky');
                    header.style.zIndex = "999"; // Restaura o z-index original
                }
            } else {
                // Restaura as posições iniciais
                topBar.style.top = "0";
                header.style.top = "60px";
                header.classList.remove('sticky');
                header.style.zIndex = "999"; // Restaura o z-index original
            }
        });

        document.querySelectorAll('.language-option').forEach(option => {
            option.addEventListener('click', function() {
                // Remove a classe 'active' de todas as opções
                document.querySelectorAll('.language-option').forEach(opt => opt.classList.remove('active'));
                
                // Adiciona a classe 'active' à opção clicada
                this.classList.add('active');
                
                // Aqui você pode adicionar a lógica para mudar o idioma
                const selectedLang = this.getAttribute('data-lang');
                console.log('Idioma selecionado:', selectedLang);
            });
        });

        // FUNÇÃO PONTOS TOTAIS OVER

        function analisarPontosTotaisOver() {
            console.log("Chamando analisarPontosTotaisOver...");

            const totalProjecaoOverElement = document.getElementById("totalprojecaoover");
            const valorAvaliarOverElement = document.getElementById("input-totalpontos-over");
            const semaforoOver = document.getElementById("semaforo-totalpontos-over");
            const frasesAnaliseOver = document.getElementById("frases-analise-totalpontos-over");

            if (!totalProjecaoOverElement || !valorAvaliarOverElement || !semaforoOver || !frasesAnaliseOver) {
                console.error("Elementos necessários não encontrados. Verifique os IDs no HTML.");
                return;
            }

            const totalProjecaoOver = parseFloat(totalProjecaoOverElement.textContent);
            const valorAvaliarOver = parseFloat(valorAvaliarOverElement.value);

            if (isNaN(totalProjecaoOver) || isNaN(valorAvaliarOver)) {
                console.error("Valores inválidos para análise de pontos totais over.");
                return;
            }

            frasesAnaliseOver.innerHTML = "";

            console.log(`Total Projeção Over: ${totalProjecaoOver}`);
            console.log(`Valor para Avaliar Over: ${valorAvaliarOver}`);

            if (valorAvaliarOver <= totalProjecaoOver - 12) {
                console.log("Condição VERDE atendida!");
                semaforoOver.style.backgroundColor = "green";
                frasesAnaliseOver.innerHTML = "<p>Excelente aposta!!!</p>";
            } else if (valorAvaliarOver > totalProjecaoOver - 12 && valorAvaliarOver <= totalProjecaoOver) {
                console.log("Condição AMARELO atendida!");
                semaforoOver.style.backgroundColor = "yellow";
                frasesAnaliseOver.innerHTML = "<p>Atenção! Aposta com tendência equilibrada.</p>";
            } else {
                console.log("Condição VERMELHO atendida!");
                semaforoOver.style.backgroundColor = "red";
                frasesAnaliseOver.innerHTML = "<p>Aposta não recomendada.</p>";
            }
        }

        // FUNÇÃO PONTOS TOTAIS UNDER

        function analisarPontosTotaisUnder() {
            console.log("Chamando analisarPontosTotaisUnder...");

            const totalProjecaoUnderElement = document.getElementById("totalprojecaounder");
            const valorAvaliarUnderElement = document.getElementById("input-totalpontos-under");
            const semaforoUnder = document.getElementById("semaforo-totalpontos-under");
            const frasesAnaliseUnder = document.getElementById("frases-analise-totalpontos-under");

            if (!totalProjecaoUnderElement || !valorAvaliarUnderElement || !semaforoUnder || !frasesAnaliseUnder) {
                console.error("Elementos necessários não encontrados. Verifique os IDs no HTML.");
                return;
            }

            const totalProjecaoUnder = parseFloat(totalProjecaoUnderElement.textContent);
            const valorAvaliarUnder = parseFloat(valorAvaliarUnderElement.value);

            if (isNaN(totalProjecaoUnder) || isNaN(valorAvaliarUnder)) {
                console.error("Valores inválidos para análise de pontos totais under.");
                return;
            }

            frasesAnaliseUnder.innerHTML = "";

            console.log(`Total Projeção Under: ${totalProjecaoUnder}`);
            console.log(`Valor para Avaliar Under: ${valorAvaliarUnder}`);

            if (valorAvaliarUnder >= totalProjecaoUnder + 12) {
                console.log("Condição VERDE atendida!");
                semaforoUnder.style.backgroundColor = "green";
                frasesAnaliseUnder.innerHTML = "<p>Excelente aposta!!!</p>";
            } else if (valorAvaliarUnder >= totalProjecaoUnder && valorAvaliarUnder < totalProjecaoUnder + 12) {
                console.log("Condição AMARELO atendida!");
                semaforoUnder.style.backgroundColor = "yellow";
                frasesAnaliseUnder.innerHTML = "<p>Atenção! Aposta com tendência equilibrada.</p>";
            } else {
                console.log("Condição VERMELHO atendida!");
                semaforoUnder.style.backgroundColor = "red";
                frasesAnaliseUnder.innerHTML = "<p>Aposta não recomendada.</p>";
            }
        }

        // FUNÇÃO HANDICAP VISITANTE

        function analisarHandicapVisitante() {
            console.log("Chamando analisarHandicapVisitante...");

            const totalProjecaoHandicapVisitanteElement = document.getElementById("totalprojecaohandicapvisitante");
            const valorAvaliarHandicapVisitanteElement = document.getElementById("input-handicap-visitante");
            const semaforoHandicapVisitante = document.getElementById("semaforo-handicap-visitante");
            const frasesAnaliseHandicapVisitante = document.getElementById("frases-analise-handicap-visitante");

            if (!totalProjecaoHandicapVisitanteElement || !valorAvaliarHandicapVisitanteElement || !semaforoHandicapVisitante || !frasesAnaliseHandicapVisitante) {
                console.error("Elementos necessários não encontrados. Verifique os IDs no HTML.");
                return;
            }

            const totalProjecaoHandicapVisitante = parseFloat(totalProjecaoHandicapVisitanteElement.textContent);
            const valorAvaliarHandicapVisitante = parseFloat(valorAvaliarHandicapVisitanteElement.value);

            if (isNaN(totalProjecaoHandicapVisitante) || isNaN(valorAvaliarHandicapVisitante)) {
                console.error("Valores inválidos para análise de pontos totais over.");
                return;
            }

            frasesAnaliseHandicapVisitante.innerHTML = "";

            console.log(`Total Projeção Handicap Visitante: ${totalProjecaoHandicapVisitante}`);
            console.log(`Valor para Avaliar Handicap Visitante: ${valorAvaliarHandicapVisitante}`);

            const valorAvaliarHandicapVisitantePreciso = parseFloat(valorAvaliarHandicapVisitante.toFixed(2));
            const totalProjecaoPreciso = parseFloat(totalProjecaoHandicapVisitante.toFixed(2));

            if (totalProjecaoPreciso > 0) {
                if (valorAvaliarHandicapVisitantePreciso < totalProjecaoPreciso) {
                    console.log("Condição VERMELHO atendida!");
                    semaforoHandicapVisitante.style.backgroundColor = "red";
                    frasesAnaliseHandicapVisitante.innerHTML = "<p>Aposta não recomendada.</p>";
                } else if (valorAvaliarHandicapVisitantePreciso >= totalProjecaoPreciso && valorAvaliarHandicapVisitantePreciso <= totalProjecaoPreciso + 6) {
                    console.log("Condição AMARELO atendida!");
                    semaforoHandicapVisitante.style.backgroundColor = "yellow";
                    frasesAnaliseHandicapVisitante.innerHTML = "<p>Atenção! Aposta com tendência equilibrada.</p>";
                } else {
                    console.log("Condição VERDE atendida!");
                    semaforoHandicapVisitante.style.backgroundColor = "green";
                    frasesAnaliseHandicapVisitante.innerHTML = "<p>Aposta não recomendada.</p>";
                }
            } else {
                if (valorAvaliarHandicapVisitantePreciso < totalProjecaoPreciso) {
                    console.log("Condição VERMELHO atendida!");
                    semaforoHandicapVisitante.style.backgroundColor = "red";
                    frasesAnaliseHandicapVisitante.innerHTML = "<p>Aposta não recomendada.</p>";
                } else if (valorAvaliarHandicapVisitantePreciso >= totalProjecaoPreciso && valorAvaliarHandicapVisitantePreciso <= totalProjecaoPreciso + 6) {
                    console.log("Condição AMARELO atendida!");
                    semaforoHandicapVisitante.style.backgroundColor = "yellow";
                    frasesAnaliseHandicapVisitante.innerHTML = "<p>Atenção! Aposta com tendência equilibrada.</p>";
                } else {
                    console.log("Condição VERDE atendida!");
                    semaforoHandicapVisitante.style.backgroundColor = "green";
                    frasesAnaliseHandicapVisitante.innerHTML = "<p>Excelente aposta!!!</p>";
                }
            }
        }

        // FUNÇÃO HANDICAP MANDANTE

        function analisarHandicapMandante() {
            console.log("Chamando analisarHandicapMandante...");

            const totalProjecaoHandicapMandanteElement = document.getElementById("totalprojecaohandicapmandante");
            const valorAvaliarHandicapMandanteElement = document.getElementById("input-handicap-mandante");
            const semaforoHandicapMandante = document.getElementById("semaforo-handicap-mandante");
            const frasesAnaliseHandicapMandante = document.getElementById("frases-analise-handicap-mandante");

            if (!totalProjecaoHandicapMandanteElement || !valorAvaliarHandicapMandanteElement || !semaforoHandicapMandante || !frasesAnaliseHandicapMandante) {
                console.error("Elementos necessários não encontrados. Verifique os IDs no HTML.");
                return;
            }

            const totalProjecaoHandicapMandante = parseFloat(totalProjecaoHandicapMandanteElement.textContent);
            const valorAvaliarHandicapMandante = parseFloat(valorAvaliarHandicapMandanteElement.value);

            if (isNaN(totalProjecaoHandicapMandante) || isNaN(valorAvaliarHandicapMandante)) {
                console.error("Valores inválidos para análise de pontos totais over.");
                return;
            }

            frasesAnaliseHandicapMandante.innerHTML = "";

            console.log(`Total Projeção Handicap Mandante: ${totalProjecaoHandicapMandante}`);
            console.log(`Valor para Avaliar Handicap Mandante: ${valorAvaliarHandicapMandante}`);

            const valorAvaliarHandicapMandantePreciso = parseFloat(valorAvaliarHandicapMandante.toFixed(2));
            const totalProjecaoPreciso = parseFloat(totalProjecaoHandicapMandante.toFixed(2));

            if (totalProjecaoPreciso > 0) {
                if (valorAvaliarHandicapMandantePreciso < totalProjecaoPreciso) {
                    console.log("Condição VERMELHO atendida!");
                    semaforoHandicapMandante.style.backgroundColor = "red";
                    frasesAnaliseHandicapMandante.innerHTML = "<p>Aposta não recomendada.</p>";
                } else if (valorAvaliarHandicapMandantePreciso >= totalProjecaoPreciso && valorAvaliarHandicapMandantePreciso <= totalProjecaoPreciso + 6) {
                    console.log("Condição AMARELO atendida!");
                    semaforoHandicapMandante.style.backgroundColor = "yellow";
                    frasesAnaliseHandicapMandante.innerHTML = "<p>Atenção! Aposta com tendência equilibrada.</p>";
                } else {
                    console.log("Condição VERDE atendida!");
                    semaforoHandicapMandante.style.backgroundColor = "green";
                    frasesAnaliseHandicapMandante.innerHTML = "<p>Aposta não recomendada.</p>";
                }
            } else {
                if (valorAvaliarHandicapMandantePreciso < totalProjecaoPreciso) {
                    console.log("Condição VERMELHO atendida!");
                    semaforoHandicapMandante.style.backgroundColor = "red";
                    frasesAnaliseHandicapMandante.innerHTML = "<p>Aposta não recomendada.</p>";
                } else if (valorAvaliarHandicapMandantePreciso >= totalProjecaoPreciso && valorAvaliarHandicapMandantePreciso <= totalProjecaoPreciso + 6) {
                    console.log("Condição AMARELO atendida!");
                    semaforoHandicapMandante.style.backgroundColor = "yellow";
                    frasesAnaliseHandicapMandante.innerHTML = "<p>Atenção! Aposta com tendência equilibrada.</p>";
                } else {
                    console.log("Condição VERDE atendida!");
                    semaforoHandicapMandante.style.backgroundColor = "green";
                    frasesAnaliseHandicapMandante.innerHTML = "<p>Excelente aposta!!!</p>";
                }
            }
        }

        // FUNÇÃO PERCENTUAL

        function calcularPercentual(resultadoFrequencia) {
            if (resultadoFrequencia === "-") return "-";
            const [numerador, denominador] = resultadoFrequencia.split('/').map(Number);
            if (denominador === 0) return "-";
            return `${Math.round((numerador / denominador) * 100)}%`;
        }

        // FUNÇÃO FREQUÊNCIA E PERCENTUAL

        async function calcularFrequencia(input, idFrequencia, idPercentual, time, tipoAnalise) {
            console.log("Função calcularFrequencia chamada!");
            console.log(`Parâmetros recebidos: input=${input}, idFrequencia=${idFrequencia}, idPercentual=${idPercentual}, time=${time}, tipoAnalise=${tipoAnalise}`);

            const valorDigitado = input.value.trim();
            console.log(`Valor digitado: ${valorDigitado}`);

            if (valorDigitado === "") {
                console.log("Valor vazio. Definindo como '-'");
                document.getElementById(idFrequencia).textContent = '-';
                document.getElementById(idPercentual).textContent = '-';
                return;
            }

            if (isNaN(valorDigitado)) {
                console.error("Valor digitado não é um número válido:", valorDigitado);
                document.getElementById(idFrequencia).textContent = '-';
                document.getElementById(idPercentual).textContent = '-';
                return;
            }

            if (!time) {
                console.error("Nome do time não foi passado corretamente.");
                document.getElementById(idFrequencia).textContent = '-';
                document.getElementById(idPercentual).textContent = '-';
                return;
            }

            try {
                // Simulação da resposta da API
                const data = { resultado: "10/20" }; // Exemplo de resposta
                console.log("Resposta simulada da API:", data);

                document.getElementById(idFrequencia).textContent = data.resultado || '-';
                console.log(`Resultado atualizado para: ${data.resultado}`);

                const percentual = calcularPercentual(data.resultado);
                document.getElementById(idPercentual).textContent = percentual;
                console.log(`Percentual calculado: ${percentual}`);

                const timeFormatado = idFrequencia.includes("visitante") ? "visitante" : "mandante";
                if (tipoAnalise === "over") {
                    console.log(`Chamando atualizarAnaliseOver para o time: ${timeFormatado}`);
                    atualizarAnaliseOver(timeFormatado);
                } else if (tipoAnalise === "under") {
                    console.log(`Chamando atualizarAnaliseUnder para o time: ${timeFormatado}`);
                    atualizarAnaliseUnder(timeFormatado);
                }
            } catch (error) {
                console.error("Erro ao calcular frequência:", error);
                document.getElementById(idFrequencia).textContent = '-';
                document.getElementById(idPercentual).textContent = '-';
            }
        }

        // FUNÇÃO PONTOS POR TIME OVER

        function atualizarAnaliseOver(time) {
            console.log(`Chamando atualizarAnaliseOver para o time: ${time}`);

            // Novos IDs com sufixo -over
            const pontosPrevistosElement = document.getElementById(`pontos-previstos-${time}-over`);
            const pontosPermitidosElement = document.getElementById(`pontos-permitidos-${time}-over`);
            const valorAvaliarElement = document.getElementById(`input-${time}-over`);
            const rankingTempElement = document.getElementById(`ranking-temp-${time}-over`);
            const rankingLast5Element = document.getElementById(`ranking-last5-${time}-over`);
            const freqPercentualElement = document.getElementById(`percentual-${time}-over`);
            const semaforo = document.getElementById(`semaforo-${time}-over`);
            const frasesAnalise = document.getElementById(`frases-analise-${time}-over`);

            // Busca o elemento do semáforo
            console.log("Elemento do frases analise encontrado:", frasesAnalise);

            if (!frasesAnalise) {
                console.error(`frasesAnalise para o time ${time} não encontrado. Verifique o ID no HTML.`);
                return;
            }

            // Verifica se todos os elementos foram encontrados
            if (!pontosPrevistosElement || !pontosPermitidosElement || !valorAvaliarElement || !rankingTempElement || !rankingLast5Element || !freqPercentualElement || !semaforo || !frasesAnalise) {
                console.error(`Elementos para o time ${time} não encontrados. Verifique os IDs no HTML.`);
                return;
            }

            // Extrai os valores dos elementos
            const pontosPrevistos = parseFloat(pontosPrevistosElement.textContent);
            const pontosPermitidos = parseFloat(pontosPermitidosElement.textContent);
            const valorAvaliar = parseFloat(valorAvaliarElement.value);
            const rankingTemp = parseInt(rankingTempElement.textContent);
            const rankingLast5 = parseInt(rankingLast5Element.textContent);
            const freqPercentual = parseInt(freqPercentualElement.textContent);

            // Verifica se os valores são válidos
            if (isNaN(pontosPrevistos) || isNaN(pontosPermitidos) || isNaN(valorAvaliar) || isNaN(rankingTemp) || isNaN(rankingLast5) || isNaN(freqPercentual)) {
                console.error(`Valores inválidos para o time ${time}. Verifique os dados.`);
                return;
            }

            // Limpa as frases de análise anteriores
            frasesAnalise.innerHTML = "";

            console.log(`Valores para ${time} (Over):`);
            console.log(`Pontos Previstos: ${pontosPrevistos}`);
            console.log(`Pontos Permitidos: ${pontosPermitidos}`);
            console.log(`Valor para Avaliar: ${valorAvaliar}`);
            console.log(`Ranking Temp: ${rankingTemp}`);
            console.log(`Ranking Last 5: ${rankingLast5}`);
            console.log(`Frequência Percentual: ${freqPercentual}`);

            // Lógica do semáforo e frases
            if (
                pontosPrevistos >= valorAvaliar && // Nova condição
                pontosPermitidos >= valorAvaliar &&
                rankingTemp > 20 &&
                rankingLast5 > 20 &&
                freqPercentual >= 80
            ) {
                console.log("Condição VERDE atendida!");
                semaforo.style.backgroundColor = "green";
                frasesAnalise.innerHTML = "<p>Excelente aposta!!!</p>";
                return;
            }

            // Condição VERMELHO
            if (
                pontosPrevistos < valorAvaliar ||
                pontosPermitidos < valorAvaliar ||
                rankingTemp < 4 ||
                rankingLast5 < 4 ||
                freqPercentual < 60
            ) {
                console.log("Condição VERMELHO atendida!");
                semaforo.style.backgroundColor = "red";

                const frasesVermelho = [];
                if (pontosPrevistos < valorAvaliar) {
                    frasesVermelho.push("Pontos previstos menor que o valor avaliado");
                }
                if (pontosPermitidos < valorAvaliar) {
                    frasesVermelho.push("Pontos permitidos menor que o valor avaliado");
                }
                if (rankingTemp < 4) {
                    frasesVermelho.push("Defesa adversária muito forte na temporada regular");
                }
                if (rankingLast5 < 4) {
                    frasesVermelho.push("Defesa adversária muito forte nos últimos 5 jogos");
                }
                if (freqPercentual < 60) {
                    frasesVermelho.push("Baixa frequência dessa pontuação nos últimos 10 jogos");
                }

                frasesAnalise.innerHTML = frasesVermelho.map(frase => `<p>${frase}</p>`).join("");
                return;
            }

            // Condição AMARELO

            if (
                pontosPrevistos >= valorAvaliar ||
                pontosPermitidos >= valorAvaliar ||
                (
                    (rankingTemp > 3 && rankingTemp < 21) ||
                    (rankingLast5 > 3 && rankingLast5 < 21) ||
                    (freqPercentual > 60 && freqPercentual < 80)
                )
            ) {
                console.log("Condição AMARELO atendida!");
                semaforo.style.backgroundColor = "yellow";

                const frasesAmarelo = [];
                if (valorAvaliar <= pontosPrevistos && valorAvaliar >= pontosPrevistos - 6) {
                    frasesAmarelo.push("Valor avaliado próximo dos pontos previstos (diferença de até 6 pontos)");
                }
                if (valorAvaliar <= pontosPermitidos && valorAvaliar >= pontosPermitidos - 6) {
                    frasesAmarelo.push("Valor avaliado próximo dos pontos permitidos (diferença de até 6 pontos)");
                }
                if (rankingTemp > 3 && rankingTemp < 21) {
                    frasesAmarelo.push("Atenção com a defesa adversária. Bons números na temporada regular");
                }
                if (rankingLast5 > 3 && rankingLast5 < 21) {
                    frasesAmarelo.push("Atenção com a defesa adversária. Bons números nos últimos 5 jogos");
                }
                if (freqPercentual > 60 && freqPercentual < 80) {
                    frasesAmarelo.push("Atenção para a frequência dessa pontuação nos últimos 10 jogos");
                }

                frasesAnalise.innerHTML = frasesAmarelo.map(frase => `<p>${frase}</p>`).join("");
                return;
            }

            // Caso nenhuma condição seja atendida
            console.log("Nenhuma condição atendida. Semáforo cinza.");
            semaforo.style.backgroundColor = "gray";
            frasesAnalise.innerHTML = "<p>Sem análise disponível.</p>";
        }

        // FUNÇÃO PONTOS POR TIME UNDER

        function atualizarAnaliseUnder(time) {
            console.log(`Chamando atualizarAnaliseUnder para o time: ${time}`);

            // Novos IDs com sufixo -under
            const pontosPrevistosElement = document.getElementById(`pontos-previstos-${time}-over`);
            const pontosPermitidosElement = document.getElementById(`pontos-permitidos-${time}-under`);
            const valorAvaliarElement = document.getElementById(`input-${time}-under`);
            const rankingTempElement = document.getElementById(`ranking-temp-${time}-under`);
            const rankingLast5Element = document.getElementById(`ranking-last5-${time}-under`);
            const freqPercentualElement = document.getElementById(`percentual-${time}-under`);
            const semaforo = document.getElementById(`semaforo-${time}-under`);
            const frasesAnalise = document.getElementById(`frases-analise-${time}-under`);

            // Busca o elemento do semáforo
            console.log("Elemento do frases analise encontrado:", frasesAnalise);

            if (!frasesAnalise) {
                console.error(`frasesAnalise para o time ${time} não encontrado. Verifique o ID no HTML.`);
                return;
            }

            // Verifica se todos os elementos foram encontrados
            if (!pontosPrevistosElement || !pontosPermitidosElement || !valorAvaliarElement || !rankingTempElement || !rankingLast5Element || !freqPercentualElement || !semaforo || !frasesAnalise) {
                console.error(`Elementos para o time ${time} não encontrados. Verifique os IDs no HTML.`);
                return;
            }

            // Extrai os valores dos elementos
            const pontosPrevistos = parseFloat(pontosPrevistosElement.textContent);
            const pontosPermitidos = parseFloat(pontosPermitidosElement.textContent);
            const valorAvaliar = parseFloat(valorAvaliarElement.value);
            const rankingTemp = parseInt(rankingTempElement.textContent);
            const rankingLast5 = parseInt(rankingLast5Element.textContent);
            const freqPercentual = parseInt(freqPercentualElement.textContent);

            // Verifica se os valores são válidos
            if (isNaN(pontosPrevistos) || isNaN(pontosPermitidos) || isNaN(valorAvaliar) || isNaN(rankingTemp) || isNaN(rankingLast5) || isNaN(freqPercentual)) {
                console.error(`Valores inválidos para o time ${time}. Verifique os dados.`);
                return;
            }

            // Limpa as frases de análise anteriores
            frasesAnalise.innerHTML = "";

            console.log(`Valores para ${time} (Under):`);
            console.log(`Pontos Previstos: ${pontosPrevistos}`);
            console.log(`Pontos Permitidos: ${pontosPermitidos}`);
            console.log(`Valor para Avaliar: ${valorAvaliar}`);
            console.log(`Ranking Temp: ${rankingTemp}`);
            console.log(`Ranking Last 5: ${rankingLast5}`);
            console.log(`Frequência Percentual: ${freqPercentual}`);

            // Lógica do semáforo e frases
            if (
                pontosPrevistos <= valorAvaliar &&
                pontosPermitidos <= valorAvaliar &&
                rankingTemp > 20 &&
                rankingLast5 > 20 &&
                freqPercentual >= 80
            ) {
                console.log("Condição VERDE atendida!");
                semaforo.style.backgroundColor = "green";
                frasesAnalise.innerHTML = "<p>Excelente aposta!!!</p>";
                return;
            }

            // Condição VERMELHO
            if (
                pontosPrevistos > valorAvaliar ||
                pontosPermitidos > valorAvaliar ||
                rankingTemp < 4 ||
                rankingLast5 < 4 ||
                freqPercentual < 60
            ) {
                console.log("Condição VERMELHO atendida!");
                semaforo.style.backgroundColor = "red";

                const frasesVermelho = [];
                if (pontosPrevistos > valorAvaliar) {
                    frasesVermelho.push("Pontos previstos maior que o valor avaliado");
                }
                if (pontosPermitidos > valorAvaliar) {
                    frasesVermelho.push("Pontos permitidos maior que o valor avaliado");
                }
                if (rankingTemp < 4) {
                    frasesVermelho.push("Defesa adversária muito forte na temporada regular");
                }
                if (rankingLast5 < 4) {
                    frasesVermelho.push("Defesa adversária muito forte nos últimos 5 jogos");
                }
                if (freqPercentual < 60) {
                    frasesVermelho.push("Baixa frequência desse valor nos últimos 10 jogos");
                }

                frasesAnalise.innerHTML = frasesVermelho.map(frase => `<p>${frase}</p>`).join("");
                return;
            }

            // Condição AMARELO
            if (
                pontosPrevistos <= valorAvaliar ||
                pontosPermitidos <= valorAvaliar ||
                (
                    (rankingTemp > 3 && rankingTemp < 21) ||
                    (rankingLast5 > 3 && rankingLast5 < 21) ||
                    (freqPercentual > 60 && freqPercentual < 80)
                )
            ) {
                console.log("Condição AMARELO atendida!");
                semaforo.style.backgroundColor = "yellow";

                const frasesAmarelo = [];
                if (valorAvaliar >= pontosPrevistos && valorAvaliar <= pontosPrevistos + 6) {
                    frasesAmarelo.push("Valor avaliado próximo dos pontos previstos (diferença de até 6 pontos)");
                }
                if (valorAvaliar >= pontosPermitidos && valorAvaliar <= pontosPermitidos + 6) {
                    frasesAmarelo.push("Valor avaliado próximo dos pontos permitidos (diferença de até 6 pontos)");
                }
                if (rankingTemp > 3 && rankingTemp < 21) {
                    frasesAmarelo.push("Atenção com a defesa adversária. Bons números na temporada regular");
                }
                if (rankingLast5 > 3 && rankingLast5 < 21) {
                    frasesAmarelo.push("Atenção com a defesa adversária. Bons números nos últimos 5 jogos");
                }
                if (freqPercentual > 60 && freqPercentual < 80) {
                    frasesAmarelo.push("Atenção para a frequência dessa pontuação nos últimos 10 jogos");
                }

                frasesAnalise.innerHTML = frasesAmarelo.map(frase => `<p>${frase}</p>`).join("");
                return;
            }

            // Caso nenhuma condição seja atendida
            console.log("Nenhuma condição atendida. Semáforo cinza.");
            semaforo.style.backgroundColor = "gray";
            frasesAnalise.innerHTML = "<p>Sem análise disponível.</p>";
        }

        const MAPEAMENTO_NOMES = {
            "Atlanta Hawks": "Atlanta",
            "Boston Celtics": "Boston",
            "Brooklyn Nets": "Brooklyn",
            "Charlotte Hornets": "Charlotte",
            "Chicago Bulls": "Chicago",
            "Cleveland Cavaliers": "Cleveland",
            "Dallas Mavericks": "Dallas",
            "Denver Nuggets": "Denver",
            "Detroit Pistons": "Detroit",
            "Golden State Warriors": "Golden State",
            "Houston Rockets": "Houston",
            "Indiana Pacers": "Indiana",
            "Los Angeles Clippers": "LA Clippers",
            "Los Angeles Lakers": "LA Lakers",
            "Memphis Grizzlies": "Memphis",
            "Miami Heat": "Miami",
            "Milwaukee Bucks": "Milwaukee",
            "Minnesota Timberwolves": "Minnesota",
            "New Orleans Pelicans": "New Orleans",
            "New York Knicks": "New York",
            "Oklahoma City Thunder": "Oklahoma City",
            "Orlando Magic": "Orlando",
            "Philadelphia 76ers": "Philadelphia",
            "Phoenix Suns": "Phoenix",
            "Portland Trail Blazers": "Portland",
            "Sacramento Kings": "Sacramento",
            "San Antonio Spurs": "San Antonio",
            "Toronto Raptors": "Toronto",
            "Utah Jazz": "Utah",
            "Washington Wizards": "Washington",
        };

        // FUNÇÃO HANDICAP NOME MOBILE

        document.addEventListener("DOMContentLoaded", function () {
            // Seleciona a div que já existe e tem os dados dos times
            const tabelaContainer = document.querySelector('.tabela-handicap-container');

            const nomeVisitante = tabelaContainer.dataset.nomeVisitante;
            const nomeMandante = tabelaContainer.dataset.nomeMandante;

            const nomeCurtoVisitante = MAPEAMENTO_NOMES[nomeVisitante] || nomeVisitante;
            const nomeCurtoMandante = MAPEAMENTO_NOMES[nomeMandante] || nomeMandante;

            // Preenche direto nos spans já existentes
            document.getElementById('mobile-nome-visitante').textContent = nomeCurtoVisitante;
            document.getElementById('mobile-nome-mandante').textContent = nomeCurtoMandante;
        });

        // FUNÇÃO RANKINGS

        async function carregarRankings() {
            try {
                const response = await fetch("/rankings");
                const data = await response.json();

                if (data.error) {
                    console.error("Erro ao carregar rankings:", data.error);
                    return;
                }

                const nomeVisitante = "{{ nome_visitante }}";
                const nomeMandante = "{{ nome_mandante }}";
                const nomeRankingVisitante = MAPEAMENTO_NOMES[nomeVisitante] || nomeVisitante;
                const nomeRankingMandante = MAPEAMENTO_NOMES[nomeMandante] || nomeMandante;

                const rankingVisitanteTabela1 = data.tabela1.find(time => time.TEAM === nomeRankingVisitante);
                const rankingVisitanteTabela2 = data.tabela2.find(time => time.TEAM_2 === nomeRankingVisitante);

                const rankingMandanteTabela1 = data.tabela1.find(time => time.TEAM === nomeRankingMandante);
                const rankingMandanteTabela2 = data.tabela2.find(time => time.TEAM_2 === nomeRankingMandante);

                // Atualiza os rankings para Over e Under (invertido entre visitande e mandante)
                if (rankingVisitanteTabela1) {
                    document.getElementById("ranking-temp-visitante-over").textContent = rankingMandanteTabela1 ? rankingMandanteTabela1.Ranking : "-";
                    document.getElementById("ranking-temp-visitante-under").textContent = rankingMandanteTabela1 ? rankingMandanteTabela1.Ranking : "-";
                }
                if (rankingVisitanteTabela2) {
                    document.getElementById("ranking-last5-visitante-over").textContent = rankingMandanteTabela2 ? rankingMandanteTabela2.Ranking : "-";
                    document.getElementById("ranking-last5-visitante-under").textContent = rankingMandanteTabela2 ? rankingMandanteTabela2.Ranking : "-";
                }

                if (rankingMandanteTabela1) {
                    document.getElementById("ranking-temp-mandante-over").textContent = rankingVisitanteTabela1 ? rankingVisitanteTabela1.Ranking : "-";
                    document.getElementById("ranking-temp-mandante-under").textContent = rankingVisitanteTabela1 ? rankingVisitanteTabela1.Ranking : "-";
                }
                if (rankingMandanteTabela2) {
                    document.getElementById("ranking-last5-mandante-over").textContent = rankingVisitanteTabela2 ? rankingVisitanteTabela2.Ranking : "-";
                    document.getElementById("ranking-last5-mandante-under").textContent = rankingVisitanteTabela2 ? rankingVisitanteTabela2.Ranking : "-";
                }

            } catch (error) {
                console.error("Erro ao carregar rankings:", error);
            }
        }

        window.onload = carregarRankings;

        // FUNÇÃO JOGADORES VISITANTE

        function analisarJogadoresVisitante(inputElement) {
            console.log("Chamando analisarJogadoresVisitante...");

            const linha = inputElement.closest("tr");

            const criterio = linha.getAttribute("data-criterio");

            const valorComparacao = criterio === "Pontos" ? 4 : 2;

            const mediaJogadoresVisitante = parseFloat(linha.querySelector(".media-jogadores-visitante").textContent);
            const valorAvaliarJogadoresVisitante = parseFloat(inputElement.value);
            const semaforoJogadoresVisitante = linha.querySelector(".semaforo-jogadores-visitante");

            if (isNaN(mediaJogadoresVisitante) || isNaN(valorAvaliarJogadoresVisitante)) {
                console.error("Valores inválidos para análise de jogadores visitantes.");
                return;
            }

            if (valorAvaliarJogadoresVisitante >= mediaJogadoresVisitante) {
                console.log("Condição VERMELHO atendida!");
                semaforoJogadoresVisitante.style.backgroundColor = "red";
            } else if (valorAvaliarJogadoresVisitante < mediaJogadoresVisitante && valorAvaliarJogadoresVisitante > mediaJogadoresVisitante - valorComparacao) {
                console.log("Condição AMARELO atendida!");
                semaforoJogadoresVisitante.style.backgroundColor = "yellow";
            } else {
                console.log("Condição VERDE atendida!");
                semaforoJogadoresVisitante.style.backgroundColor = "green";
            }
        }

        // FUNÇÃO JOGADORES MANDANTE

        function analisarJogadoresMandante(inputElement) {
            console.log("Chamando analisarJogadoresMandante...");

            const linha = inputElement.closest("tr");

            const criterio = linha.getAttribute("data-criterio");

            const valorComparacao = criterio === "Pontos" ? 4 : 2;

            const mediaJogadoresMandante = parseFloat(linha.querySelector(".media-jogadores-mandante").textContent);
            const valorAvaliarJogadoresMandante = parseFloat(inputElement.value);
            const semaforoJogadoresMandante = linha.querySelector(".semaforo-jogadores-mandante");

            if (isNaN(mediaJogadoresMandante) || isNaN(valorAvaliarJogadoresMandante)) {
                console.error("Valores inválidos para análise de jogadores mandantes.");
                return;
            }

            if (valorAvaliarJogadoresMandante >= mediaJogadoresMandante) {
                console.log("Condição VERMELHO atendida!");
                semaforoJogadoresMandante.style.backgroundColor = "red";
            } else if (valorAvaliarJogadoresMandante < mediaJogadoresMandante && valorAvaliarJogadoresMandante > mediaJogadoresMandante - valorComparacao) {
                console.log("Condição AMARELO atendida!");
                semaforoJogadoresMandante.style.backgroundColor = "yellow";
            } else {
                console.log("Condição VERDE atendida!");
                semaforoJogadoresMandante.style.backgroundColor = "green";
            }
        }

    </script>

</body>
</html>